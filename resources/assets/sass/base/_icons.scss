$icon-size: 16px;

/**
 * Generate a base icon style
 * @param  {Boolean} $use-default-icon: false - If true, it will use the 'page' icon as default
 */
@mixin base-icon($use-default-icon: false) {
  // add space for icon
  position: relative;
  padding-left: 24px;
  line-height: 1.5em;
  &:before {
    @include size($icon-size);
    content: '';
    position: absolute;
    // adjust top of icons to default center them
    top: 3px;
    left: 0;

    // default to page icon
    @if $use-default-icon {
      $svg: get-icon(page);
      background: url($svg) no-repeat;
    }
  }
}

/**
 * Generate content-types-icons SVG based on color provided
 * @param {Color} $color
 * @return {Map} $content-types-icons
 */
@function get-icons($color: $brand-primary) {
  @if type-of($color) != color {
    @error '`#{$color}` is not a color for `get-icons`';
    @return null;
  }
  $encodedColor: str-replace('#{$color}', '#', '%23');

  // since IE11 is really picky with encoded SVGs, we need to use and escape single quotes
  $IE11-fix: 'preserveAspectRatio=\'xMaxYMin\'';

  // IE11 *must* use this quoting format of encoded SVGs or it just won't work.
  // "data:image... attr='' ..."
  $content-type-icons: (
    // default icon
    page:                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='none' d='M13.552 12.237c0 1.65-1.35 3-3 3H5.449c-1.65 0-3-1.35-3-3V3.763c0-1.65 1.306-3 2.902-3s3.847.964 5.001 2.143l1.1 1.122c1.155 1.179 2.1 3.493 2.1 5.143v3.066z'/%3E%3Cpath fill='#{$encodedColor}' d='M13.375 16H2.625c-.518 0-.939-.422-.939-.939V.939C1.687.422 2.108 0 2.625 0h5.452c.301 0 .633.139.845.355l5.052 5.156c.207.211.341.54.341.836v8.713c-.001.518-.422.94-.94.94zM3.213 14.474h9.575V6.483L7.933 1.526h-4.72v12.948z'/%3E%3Cpath fill='#{$encodedColor}' d='M4.527 11.521h6.948v1.495H4.527zM4.527 8.507h6.948v1.495H4.527zM4.527 5.493H9.36v1.495H4.527z'/%3E%3C/svg%3E",

    blog:                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' fill='#{$encodedColor}' d='M15 16H1c-.553 0-1-.446-1-.999V1c0-.553.447-1 1-1h9.999L9 2H2v12.001h12V7l2-2v10.001c0 .553-.447.999-1 .999zM4 12V9.001L12.999 0H14l2 2v1l-9 9H4zm4.5-3.499L14 3l-1.001-1L7.5 7.5l1 1.001zm-2.5.5l-1 1V11h1l1-.999-1-1z'/%3E%3C/svg%3E",
    case-studies:        "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M2.731 0v3.17c.464-.159.953-.263 1.469-.263.157 0 .305.03.457.045V1.926h8.468v10.329l1.372 1.065-1.921 1.841h2.475V0H2.731zM6.289 13.234H4.657v-2.002c-.152.015-.3.046-.457.046-.517 0-1.005-.105-1.469-.264v4.146H7.68l-1.391-1.926z'/%3E%3C/g%3E%3Cpath fill='#{$encodedColor}' d='M8.901 2.925h3.212v.832H8.901zM8.901 4.9h3.212v.832H8.901zM8.901 6.875h3.212v.833H8.901zM7.719 9.422c-.469.704-1.074 1.165-1.852 1.519L9.538 16l3.011-2.883-4.83-3.695zM4.2 4.861c1.216 0 2.202.984 2.202 2.2 0 1.217-.986 2.202-2.202 2.202-1.215 0-2.201-.985-2.201-2.202 0-1.215.986-2.2 2.201-2.2m0-1.05C2.407 3.811.949 5.27.949 7.062c0 1.793 1.458 3.252 3.251 3.252s3.251-1.459 3.251-3.252c0-1.792-1.458-3.251-3.251-3.251z'/%3E%3C/svg%3E",
    course-info:         "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M14.926 2.564L8.271 5.309c-.038.016-.078.024-.119.024L8 5.334l-.152-.001c-.041 0-.082-.008-.119-.024L1.062 2.564C.318 2.266 0 2.756 0 2.94v8.809c0 .412.259.781.647.922l7.081 2.544c.038.015.078.021.119.021h.305c.041 0 .081-.006.119-.021l7.08-2.544c.391-.141.649-.51.649-.922V2.94c0-.184-.33-.674-1.074-.376zM1.329 11.241V4.443c0-.15.152-.252.291-.195L7.325 6.58v7.074l-5.671-2.011c-.195-.07-.325-.195-.325-.402zm13.335.007c0 .206-.131.334-.324.401l-5.644 2.007V6.58l5.677-2.326c.139-.057.291.045.291.195v6.799z'/%3E%3Cpath fill='#{$encodedColor}' d='M14.826 1.409L13.793.764l-5.744 2.25c-.047.019-.099.019-.146 0L2.097.764l-1.033.645 6.815 2.797c.051.021.108.021.158 0l6.789-2.797z'/%3E%3C/svg%3E",
    ebook:               "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M4.527 9.1h6.945v1.494H4.527zM4.527 6.085h6.945V7.58H4.527zM4.527 3.072H9.36v1.495H4.527z'/%3E%3C/g%3E%3Cpath fill='#{$encodedColor}' d='M12.185 0H3.816C2.525 0 1.468 1.057 1.468 2.349v11.304c0 1.29 1.057 2.347 2.348 2.347h8.369c1.292 0 2.348-1.057 2.348-2.348V2.349C14.532 1.057 13.477 0 12.185 0zM8 15.051c-.497 0-.9-.402-.9-.9 0-.496.403-.9.9-.9s.9.404.9.9c0 .497-.403.9-.9.9zm4.946-3.104H3.055V1.699h9.892v10.248z'/%3E%3C/svg%3E",
    event:               "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M1.567 3.991h13.142v2.494H1.567z'/%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M6.553 1.013v3.225c0 .18.146.325.325.325h2.48c.18 0 .324-.145.324-.325V1.013c0-.179-.145-.325-.324-.325h-2.48c-.18 0-.325.145-.325.325z'/%3E%3Cpath d='M15.564.688h-2.061l.002 12.13H2.494L2.492.688H.436C.195.688 0 .883 0 1.124v13.753c0 .24.195.436.436.436h15.129c.24 0 .436-.195.436-.436V1.124C16 .883 15.805.688 15.564.688z'/%3E%3C/g%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M4.476 7.459h1.717v1.674H4.476zM3.643 1.446H5.36v1.673H3.643zM10.77 1.446h1.717v1.673H10.77zM7.19 7.459h1.719v1.674H7.19zM9.906 7.459h1.717v1.674H9.906zM4.476 10.1h1.717v1.672H4.476zM7.168 10.1h1.719v1.672H7.168zM9.861 10.1h1.717v1.672H9.861z'/%3E%3C/g%3E%3C/svg%3E",
    video:               "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M8 16c-4.417 0-8-3.581-8-8s3.583-8 8-8c4.418 0 8 3.581 8 8s-3.582 8-8 8zM8 2C4.687 2 2 4.687 2 8s2.686 5.999 6 5.999S14 11.313 14 8s-2.686-6-6-6zM6 5l5 3-5 2.999V5z'/%3E%3C/svg%3E",
    topic-page:          "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M15.511.199H3.629c-.27 0-.489.219-.489.489v2.466H.484c-.267 0-.484.217-.484.484v11.678c0 .268.217.484.484.484h11.892c.268 0 .484-.217.484-.484v-2.471h2.65c.271 0 .489-.219.489-.49V.688c.001-.271-.218-.489-.488-.489zm-4.58 13.674H1.929v-8.79h9.001v8.79zm3.14-3.445c0 .27-.22.488-.489.488h-.722V3.638c0-.268-.217-.484-.484-.484H5.069v-.537c0-.271.219-.489.489-.489h8.023c.27 0 .489.219.489.489v7.811z'/%3E%3Cpath fill='none' d='M11.86 8.749H1.212'/%3E%3Cpath fill='#{$encodedColor}' d='M1.212 7.784H11.86v1.929H1.212zM2.762 5.82h1.037v1.115H2.762zM4.9 5.82h1.038v1.115H4.9zM7.041 5.82h1.037v1.115H7.041zM9.18 5.82h1.037v1.115H9.18z'/%3E%3C/svg%3E",
    // not a content type,
    // but used as a topic-page icon
    preferences:         "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M15.511.199H3.629c-.27 0-.489.219-.489.489v2.466H.484c-.267 0-.484.217-.484.484v11.678c0 .268.217.484.484.484h11.892c.268 0 .484-.217.484-.484v-2.471h2.65c.271 0 .489-.219.489-.49V.688c.001-.271-.218-.489-.488-.489zm-4.58 13.674H1.929v-8.79h9.001v8.79zm3.14-3.445c0 .27-.22.488-.489.488h-.722V3.638c0-.268-.217-.484-.484-.484H5.069v-.537c0-.271.219-.489.489-.489h8.023c.27 0 .489.219.489.489v7.811z'/%3E%3Cpath fill='none' d='M11.86 8.749H1.212'/%3E%3Cpath fill='#{$encodedColor}' d='M1.212 7.784H11.86v1.929H1.212zM2.762 5.82h1.037v1.115H2.762zM4.9 5.82h1.038v1.115H4.9zM7.041 5.82h1.037v1.115H7.041zM9.18 5.82h1.037v1.115H9.18z'/%3E%3C/svg%3E",
    external-resource:   "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M16 0H3l3.6 3.301H0v12.6h12.5v-6.8l3.5 3.2V0zm-2.1 7.801L11.7 5.7l-5.2 5.2 1.4 1.4 2.6-2.6v4.101H2.1V5.5H6L3.5 7.9l1.4 1.4 5.3-5.2L8 2h6l-.1 5.801z'/%3E%3C/svg%3E",
    // program-info === program-module
    program-info:        "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M7.758 12.324l-1.081.846c-.073.058-.181.035-.225-.047l-.509-.959-.045.022-2.2 3.086c-.065.092-.01.22.102.235l3.062.415c.077.01.149-.04.166-.116l.769-3.453-.039-.029zM9.378 13.133l-.457-.433c-.1-.095-.263-.003-.233.133l.676 3.057c.017.075.09.122.165.107l2.841-.568c.096-.02.144-.128.093-.211l-1.864-3.081c-.051-.084-.17-.091-.23-.014l-.782.995c-.053.065-.149.071-.209.015z'/%3E%3Cg%3E%3Ccircle cx='7.979' cy='5.695' r='1.827'/%3E%3Cpath d='M13.64 6.263l-1.042-1.077.795-1.268-1.387-.56.207-1.482-1.494.054-.411-1.44-1.348.659L8 0l-.96 1.149-1.348-.66-.409 1.441-1.497-.053.212 1.482-1.392.56.795 1.268L2.36 6.263l1.242.835-.512 1.409 1.477.256.101 1.498 1.452-.366.7 1.323L8 10.293l1.18.925.699-1.323 1.453.366.104-1.498 1.475-.256-.514-1.408 1.243-.836zm-5.934 2.79c-1.633-.129-2.955-1.452-3.084-3.085-.163-2.075 1.559-3.795 3.632-3.63 1.632.13 2.953 1.451 3.083 3.083.165 2.073-1.556 3.794-3.631 3.632z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E",
    program-module:      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M7.758 12.324l-1.081.846c-.073.058-.181.035-.225-.047l-.509-.959-.045.022-2.2 3.086c-.065.092-.01.22.102.235l3.062.415c.077.01.149-.04.166-.116l.769-3.453-.039-.029zM9.378 13.133l-.457-.433c-.1-.095-.263-.003-.233.133l.676 3.057c.017.075.09.122.165.107l2.841-.568c.096-.02.144-.128.093-.211l-1.864-3.081c-.051-.084-.17-.091-.23-.014l-.782.995c-.053.065-.149.071-.209.015z'/%3E%3Cg%3E%3Ccircle cx='7.979' cy='5.695' r='1.827'/%3E%3Cpath d='M13.64 6.263l-1.042-1.077.795-1.268-1.387-.56.207-1.482-1.494.054-.411-1.44-1.348.659L8 0l-.96 1.149-1.348-.66-.409 1.441-1.497-.053.212 1.482-1.392.56.795 1.268L2.36 6.263l1.242.835-.512 1.409 1.477.256.101 1.498 1.452-.366.7 1.323L8 10.293l1.18.925.699-1.323 1.453.366.104-1.498 1.475-.256-.514-1.408 1.243-.836zm-5.934 2.79c-1.633-.129-2.955-1.452-3.084-3.085-.163-2.075 1.559-3.795 3.632-3.63 1.632.13 2.953 1.451 3.083 3.083.165 2.073-1.556 3.794-3.631 3.632z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E",
    series:              "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M5.188 8.213L2.972 5.118 0 7.249l4.459 6.224 2.352-1.639H5.203M16.0006 6.5148l-3.275 6.9212-3.3064-1.5645 3.275-6.9212zM9.861 8.006V2.528H6.205v7.921h2.45'/%3E%3C/g%3E%3Cg fill='%23045262'%3E%3Cpath d='M5.188 8.213L2.972 5.118 0 7.249l4.459 6.224 2.352-1.639H5.203M16.0006 6.5148l-3.275 6.9212-3.3064-1.5645 3.275-6.9212zM9.861 8.006V2.528H6.205v7.921h2.45'/%3E%3C/g%3E%3C/svg%3E",
    job-aids:            "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M15.851 5.59l-.614-.58c-.13-.124-.33-.14-.479-.038L8.896 8.961c-.14.094-.324.087-.455-.018L6.708 7.558c-.176-.142-.437-.1-.561.09l-.621.953c-.091.14-.081.323.025.454l2.458 2.984c.134.162.375.188.539.055l7.28-5.928c.181-.146.191-.417.023-.576z'/%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M10.453 4.924c-.047 0-.094-.005-.141-.018L5.24 3.647c-.312-.078-.503-.395-.425-.706l.444-1.786c.064-.26.297-.442.566-.442.047 0 .094.006.14.017l.889.22c.103.025.21-.041.235-.142L7.18.442C7.244.183 7.477 0 7.745 0c.047 0 .095.006.14.018l1.787.443c.15.038.277.132.358.265.08.134.104.291.066.441l-.091.366c-.013.049-.005.102.022.146.026.044.069.077.119.088l.89.222c.312.077.503.394.426.706l-.444 1.786c-.064.26-.296.442-.565.443zM5.825 1.102c-.088 0-.168.062-.189.147l-.445 1.785c-.025.105.038.21.142.236l5.073 1.26c.103.025.211-.041.236-.142l.442-1.785c.026-.104-.038-.21-.142-.236l-.89-.221c-.149-.038-.276-.132-.357-.266s-.104-.29-.066-.441l.091-.366c.013-.05.005-.102-.022-.146-.027-.046-.07-.077-.12-.09L7.792.394c-.102-.024-.21.042-.235.142l-.09.366c-.065.261-.298.443-.567.443-.047 0-.094-.006-.14-.017l-.889-.22c-.015-.005-.031-.006-.046-.006z'/%3E%3Cpath d='M8.354 2.691c-.061 0-.121-.007-.181-.021-.191-.048-.353-.167-.455-.336-.102-.17-.132-.369-.084-.562.081-.33.376-.561.717-.562.061 0 .121.008.181.023.395.098.638.5.54.896-.082.331-.377.562-.718.562zm-.003-1.092c-.161 0-.301.109-.34.266-.023.093-.009.188.039.268.049.081.125.138.217.159.192.048.382-.071.427-.256.046-.188-.069-.379-.256-.426-.029-.007-.058-.011-.087-.011z'/%3E%3C/g%3E%3Cg fill='#{$encodedColor}'%3E%3Cpath d='M13.479 3.833c.053-.211-.075-.425-.287-.478l-1.962-.489-.389 1.558.603.15-.511 2.047 2.247-1.595.299-1.193zM9.104 14.092L2.076 12.34l2.373-9.519.601.15.389-1.557L3.477.925c-.211-.053-.425.076-.477.287L.042 13.08c-.052.211.076.426.287.479l9.747 2.43c.211.053.425-.076.478-.287l1.309-5.248-2.31 1.846-.449 1.792z'/%3E%3C/g%3E%3C/svg%3E",

    // community icon
    portal-home-page:    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' #{$IE11-fix} viewBox='0 0 16 16'%3E%3Cpath fill='#{$encodedColor}' d='M13.077 6.874c0 1.642-1.335 3.818-2.977 3.818-1.646 0-2.979-2.177-2.979-3.818 0-1.645 1.332-3.186 2.979-3.186 1.642 0 2.977 1.541 2.977 3.186'/%3E%3Cpath fill='#{$encodedColor}' d='M15.969 13.775c-.42-1.125-1.394-3.354-2.525-3.354h-.681c-.111 0-.219.053-.291.139-.632.75-1.46 1.261-2.371 1.261s-1.743-.511-2.373-1.261c-.072-.086-.179-.139-.292-.139h-.679c-1.134 0-2.106 2.229-2.527 3.354-.054.146-.034.309.055.434.088.13.233.204.387.204h10.853c.156 0 .3-.074.389-.204.091-.125.109-.288.055-.434M8.073 3.591c.167-.104.22-.326.12-.494-.511-.881-1.419-1.51-2.455-1.51-1.598 0-2.895 1.5-2.895 3.102 0 1.597 1.296 3.712 2.895 3.712.179 0 .352-.029.519-.075.197-.058.31-.26.256-.454-.104-.383-.162-.77-.162-1.141 0-1.295.708-2.48 1.722-3.14M5.738 9.329c-1.034-.032-1.692-.501-2.305-1.228-.07-.083-.174-.134-.284-.134h-.662c-1.102 0-2.049 2.167-2.459 3.264-.052.142-.031.3.054.422.087.126.229.198.379.198h3.433c.116 0 .222-.067.273-.17.744-1.492 1.318-1.899 1.677-2.103 0 0 .273-.237-.106-.249z'/%3E%3C/svg%3E"
  );

  @return $content-type-icons;
}

/**
 * Generate an icon based on the type provided
 * @param {String} $type
 * @param {Color} $color
 * @return {String} icon wanted
 */
@function get-icon($type, $color: $brand-primary) {
  @if type-of($type) != string {
    @error '`#{$type}` is not a string for `get-icon`';
    @return null;
  }
  @if type-of($color) != color {
    @error '`#{$color}` is not a color for `get-icon`';
    @return null;
  }
  $icons: get-icons($color);

  // verify that it is found in the content-type-icons first
  @if map-has-key($icons, $type) {
    @return map-get($icons, $type);
  } @else {
    @error 'There is no type named `#{$type}` in $icons. '
         + 'Type should be one of: #{map-keys($icons)}.';
    @return null;
  }
}

// Generate icons style with the SVG urls
@each $content-type, $svg in get-icons() {
  .#{$content-type}.icon {
    @include base-icon();
  }
  .#{$content-type}.icon:before,
  div.content.short-view.node-#{$content-type}:before {
    background: url($svg) no-repeat;
  }
}